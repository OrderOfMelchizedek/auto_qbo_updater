## 1. SalesReceipt

**(from `https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/salesreceipt`)**

# SalesReceipt

*   **`QuickBooks Online API Reference Guide > Accounting API > Entities (A-Z) > SalesReceipt`**

**Description**

A SalesReceipt transaction represents the receipt of payment for goods or services at the time of sale. SalesReceipt is functionally the same as an Invoice except that payment is received at the time of the transaction, whereas invoices represent a receivable that is paid later. The SalesReceipt object is one of the transaction entities in QuickBooks accounting API.

**Business Rules**

The SalesReceipt object supports the following business rules:

*   `Line.Amount` is required.
*   At least one `Line` with `DetailType=SalesItemLineDetail` or `DescriptionOnly` is required.
*   `CustomerRef` is required.
*   `TotalAmt` must equal the sum of all `Line.Amount` line items. This is calculated by the service.
*   A `SalesReceipt` cannot be linked to an `Invoice`.
*   You can email a sales receipt using the `send` operation. See [Sending transactions via email](https://developer.intuit.com/app/developer/qbo/docs/workflows/manage-linked-transactions#sending-transactions-via-email) for details.

**Properties**

| Name                     | Type                                              | Description                                                                                                                                                                | Filterable | Sortable | Max Length | Min Acc. Ver | Notes                                                                                                                                                                                                                                                             |
| :----------------------- | :------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- | :------- | :--------- | :----------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Id`                     | `String`                                          | Unique identifier for this object. Sort order is ASC by default.                                                                                                           | Yes        | Yes      | 30         |              | System-assigned, immutable, unique identifier for the object.                                                                                                                                                                                                     |
| `SyncToken`              | `String`                                          | Version number of the object. It is used to lock an object for use by one client at a time. As soon as an application modifies an object, its SyncToken is incremented.      | No         | No       | 50         |              | Provide the latest `SyncToken` value when doing sparse updates. If the passed value doesn't match the existing object's SyncToken in the system, the update request is rejected.                                                                                      |
| `MetaData`               | [`ModificationMetaData`](#modificationmetadata)   | Descriptive information about the entity read from the source accounting system.                                                                                           | No         | No       |            |              | Includes the time the object was created and last updated in the QuickBooks company. See [MetaData](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/minor-versions#metadata) for more information.                               |
| `CustomField`            | [`CustomField`](#customfield) Array               | List of custom fields defined for this transaction.                                                                                                                        | Yes        | No       |            | Minor Ver. 3 | See [Custom fields](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/custom-fields) for more information. Requires minor version 3.                                                                                        |
| `DocNumber`              | `String`                                          | Reference number for the transaction. If not explicitly provided at create time, this field is generated by the service.                                                     | Yes        | Yes      | 21         |              | If the `Custom Transaction Numbers` setting is enabled for the company, the user can change the value of this field. Otherwise, the service generates this field's value behind the scenes. This value may subsequently change for a stable transaction Id.               |
| `TxnDate`                | `Date`                                            | Date of the transaction.                                                                                                                                                   | Yes        | Yes      |            |              | Format: `YYYY-MM-DD` or `YYYY-MM-DD+/-hh:mm`.                                                                                                                                                                                                                   |
| `DepartmentRef`          | [`ReferenceType`](#referencetype)                 | Reference to the [Department](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/department) object associated with this transaction.         | Yes        | No       |            | Minor Ver. 3 | Location of the transaction, as defined using location tracking in QuickBooks Online. Requires minor version 3. Requires Location Tracking feature to be enabled. See [Location](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/locations) for details. |
| `PrivateNote`            | `String`                                          | User-entered, organization-private note about the transaction. This note does not appear on the sales form to the customer.                                                  | No         | No       | 4000       |              |                                                                                                                                                                                                                                                                   |
| `LinkedTxn`              | [`LinkedTxn`](#linkedtxn) Array                   | A list of transactions linked to this object. For example, a `JournalEntry` object may be linked to a `SalesReceipt` object.                                               | No         | No       |            |              |                                                                                                                                                                                                                                                                   |
| `Line`                   | [`Line`](#line) Array                             | Individual line items of the transaction. At least one Line is required.                                                                                                   | No         | No       |            |              | Valid `Line.DetailType` values: `SalesItemLineDetail`, `GroupLineDetail`, `DescriptionOnly`, `DiscountLineDetail`, `TaxLineDetail`, `SubTotalLineDetail`.                                                                                                        |
| `TxnSource`              | `String`                                          | The source of the transaction. Derived from the transactional data and this field is locale-specific.                                                                      | No         | No       |            | Minor Ver. 4 | For example, QBO, QBMobile, etc. Requires minor version 4.                                                                                                                                                                                                        |
| `GlobalTaxCalculation`   | `GlobalTaxCalculationEnum`                        | Defines the method used to calculate taxes for this transaction.                                                                                                           | Yes        | No       |            | Minor Ver. 4 | See [Global tax model](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/taxes#global-tax-model) for details. Requires minor version 4. Possible values: `TaxExcluded`, `TaxInclusive`, `NotApplicable`.                 |
| `TotalAmt`               | `Decimal`                                         | Total amount of the transaction. This includes the total of all the charges, allowances, and taxes. Calculated by the system. Read-only.                                   | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                   |
| `CurrencyRef`            | [`ReferenceType`](#referencetype)                 | Reference to the `Currency` in which all amounts on the associated transaction are expressed.                                                                              | Yes        | No       |            |              | Required if `MultiCurrency` is enabled for the company.                                                                                                                                                                                                           |
| `ExchangeRate`           | `Decimal`                                         | Currency exchange rate. Valid only if the company is `MultiCurrency` enabled.                                                                                              | No         | No       |            |              | Valid only if `CurrencyRef` is not the home currency. If not specified, the exchange rate is calculated by the service based on the `TxnDate`. If the rate is specified, it overrides the calculated rate.                                                          |
| `CustomerRef`            | [`ReferenceType`](#referencetype)                 | **Required.** Reference to a [`Customer`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/customer) or [`Job`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/customer#sub-customers-and-jobs) associated with the transaction. | Yes        | No       |            |              |                                                                                                                                                                                                                                                                   |
| `CustomerMemo`           | [`MemoRef`](#memoref)                             | User-entered message to the customer; this message is visible to end user on their transactions.                                                                           | No         | No       | 1000       |              |                                                                                                                                                                                                                                                                   |
| `BillAddr`               | [`PhysicalAddress`](#physicaladdress)             | Billing address of the transaction.                                                                                                                                        | No         | No       |            |              | If not specified, uses the `BillAddr` of the associated `Customer`.                                                                                                                                                                                               |
| `ShipAddr`               | [`PhysicalAddress`](#physicaladdress)             | Shipping address of the transaction.                                                                                                                                       | No         | No       |            |              | If not specified, uses the `ShipAddr` of the associated `Customer`.                                                                                                                                                                                               |
| `ClassRef`               | [`ReferenceType`](#referencetype)                 | Reference to the [`Class`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/class) associated with this transaction.                         | Yes        | No       |            |              | Required if `ClassTrackingPerTxn` preference is enabled.                                                                                                                                                                                                          |
| `SalesTermRef`           | [`ReferenceType`](#referencetype)                 | Reference to the [`Term`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/term) associated with the transaction.                           | Yes        | No       |            |              | Not typically used for `SalesReceipt` as payment is immediate.                                                                                                                                                                                                    |
| `TxnTaxDetail`           | [`TxnTaxDetail`](#txntaxdetail)                   | Details of the taxes charged on the transaction as a whole. For US versions of QuickBooks Online, the `TxnTaxDetail` should provide the overall tax rate.                      | No         | No       |            |              | See [Tax models](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/taxes) for details.                                                                                                                                 |
| `PaymentMethodRef`       | [`ReferenceType`](#referencetype)                 | Reference to the [`PaymentMethod`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/paymentmethod) used for this transaction.             | Yes        | No       |            |              |                                                                                                                                                                                                                                                                   |
| `PaymentRefNum`          | `String`                                          | The reference number for the payment received (check #, etc.).                                                                                                             | Yes        | No       | 21         |              |                                                                                                                                                                                                                                                                   |
| `DepositToAccountRef`    | [`ReferenceType`](#referencetype)                 | Reference to the [`Account`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/most-commonly-used/account) where the payment money is deposited. Recommended. | Yes        | No       |            |              | If not specified, and the `Undeposited Funds` feature is enabled for the company, the `Account` object with `AccountSubType=UndepositedFunds` is used. If `Undeposited Funds` is not enabled, the `Account` is the default one specified by the company preferences.       |
| `ShipDate`               | `Date`                                            | Shipping date. Format: `YYYY-MM-DD`.                                                                                                                                       | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                   |
| `ShipMethodRef`          | [`ReferenceType`](#referencetype)                 | Reference to the [`ShipMethod`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/shipmethod) used for this transaction.                   | Yes        | No       |            |              |                                                                                                                                                                                                                                                                   |
| `TrackingNum`            | `String`                                          | Shipping provider's tracking number for the delivery.                                                                                                                      | Yes        | No       | 30         |              |                                                                                                                                                                                                                                                                   |
| `PrintStatus`            | `PrintStatusEnum`                                 | Printing status of the transaction.                                                                                                                                        | Yes        | No       |            |              | Values: `NotSet`, `NeedToPrint`, `PrintComplete`.                                                                                                                                                                                                                 |
| `EmailStatus`            | `EmailStatusEnum`                                 | Email status of the transaction.                                                                                                                                           | Yes        | No       |            |              | Values: `NotSet`, `NeedToSend`, `EmailSent`. If `EmailStatus=NeedToSend` is specified in a request, the transaction is queued for sending. Default is `NotSet`.                                                                                                    |
| `BillEmail`              | [`EmailAddress`](#emailaddress)                   | Email address. If `EmailStatus=NeedToSend` is specified, the transaction is emailed to this address.                                                                         | No         | No       |            |              | If not specified, the email address of the associated `Customer` is used.                                                                                                                                                                                         |
| `ApplyTaxAfterDiscount`  | `Boolean`                                         | If `true`, the transaction is taxable after the discount is applied. If `false`, the transaction is taxable before the discount is applied. Default is `false`.            | No         | No       |            |              |                                                                                                                                                                                                                                                                   |
| `HomeTotalAmt`           | `Decimal`                                         | Total amount of the transaction in the home currency. Read-only. Only available if `MultiCurrency` is enabled for the company.                                                | No         | No       |            |              | Includes total of all charges, allowances, and taxes. Calculated by the service.                                                                                                                                                                                  |
| `DeliveryInfo`           | `DeliveryInfo`                                    | Information about the delivery method.                                                                                                                                     | No         | No       |            |              | Includes delivery type and time.                                                                                                                                                                                                                                  |
| `CreditCardPayment`      | `CreditCardPayment`                               | Credit card payment information for this transaction.                                                                                                                      | No         | No       |            |              | Includes credit card charge information, such as amount, processing status, authorization code, etc.                                                                                                                                                                |
| `ShipFromAddr`           | `PhysicalAddress`                                 | Address where the goods are shipped from. Available for France locales only.                                                                                               | No         | No       |            | Minor Ver. 8 | Requires minor version 8.                                                                                                                                                                                                                                         |
| `ProjectRef`             | `ReferenceType`                                   | Reference to the Project entity. Available in Plus and Advanced subscriptions of QuickBooks Online.                                                                        | Yes        | No       |            | Minor Ver. 67| Requires minor version 67.                                                                                                                                                                                                                                        |
| `TaxExemptionRef`        | `ReferenceType`                                   | Reference to the tax exemption reason for the transaction.                                                                                                                 | Yes        | No       |            | Minor Ver. 41| Requires minor version 41.                                                                                                                                                                                                                                        |
| `TransactionLocationType`| `String`                                          | Applicable only for France locales. Specifies the location of the transaction.                                                                                             | No         | No       |            | Minor Ver. 8 | Values: `WithinFrance`, `OutsideFranceWithEU`, `OutsideEU`. Requires minor version 8.                                                                                                                                                                                     |
| `RecurDataRef`           | `ReferenceType`                                   | Reference to the Recurring Transaction (see [Recurring Transactions](https://developer.intuit.com/app/developer/qbo/docs/workflows/create-recurring-transactions)). Read-only. | No         | No       |            | Minor Ver. 56| Requires minor version 56.                                                                                                                                                                                                                                        |
| `InvoiceRef`             | `ReferenceType`                                   | Reference to an `Invoice` for certain French workflows where a SalesReceipt represents payment for an Invoice.                                                           | No         | No       |            | Minor Ver. 59| Represents the original Invoice for which this SalesReceipt is created. Read-only. France only. Requires minor version 59.                                                                                                                                          |
| `InvoiceStatus`          | `String`                                          | Status of the related Invoice (France only). Read-only.                                                                                                                    | No         | No       |            | Minor Ver. 59| Possible values: `Deposited`, `Paid`. Requires minor version 59.                                                                                                                                                                                                      |
| `InvoiceStatusDate`      | `Date`                                            | Date when the `InvoiceStatus` changed (France only). Read-only.                                                                                                            | No         | No       |            | Minor Ver. 59| Format: `YYYY-MM-DD`. Requires minor version 59.                                                                                                                                                                                                              |

**Operations**

The `SalesReceipt` object supports the following operations:

**Create**

*   **`POST /v3/company/<realmID>/salesreceipt`**
*   Creates a `SalesReceipt` object.

*Request Body Example (JSON)*

```json
{
  "Line": [
    {
      "Amount": 100.00,
      "DetailType": "SalesItemLineDetail",
      "SalesItemLineDetail": {
        "ItemRef": {
          "value": "1",
          "name": "Services"
        }
      }
    }
  ],
  "CustomerRef": {
    "value": "1"
  },
  "DepositToAccountRef": {
     "value": "45" // Undeposited Funds or specific Bank account ID
  },
  "PaymentMethodRef": {
    "value": "1" // e.g., Cash, Check, Credit Card
  },
  "PaymentRefNum": "Check 101"
}
```

*Response Example (JSON)*

```json
{
  "SalesReceipt": {
    "DepositToAccountRef": {
      "value": "45",
      "name": "Undeposited Funds"
    },
    "AllowIPNPayment": false,
    "CustomerRef": {
      "value": "1",
      "name": "Amy's Bird Sanctuary"
    },
    "ShipAddr": {
      "Id": "2",
      "Line1": "45 Main Street",
      "City": "Middlefield",
      "CountrySubDivisionCode": "CA",
      "PostalCode": "94303",
      "Lat": "37.445",
      "Long": "-122.139"
    },
    "BillAddr": {
      "Id": "33",
      "Line1": "123 Main Street",
      "City": "Middlefield",
      "CountrySubDivisionCode": "CA",
      "PostalCode": "94303",
      "Lat": "37.445",
      "Long": "-122.139"
    },
    "ShipMethodRef": {
      "value": "1"
    },
    "PaymentMethodRef": {
      "value": "1",
      "name": "Cash"
    },
    "PaymentRefNum": "Check 101",
    "TotalAmt": 108.00,
    "ApplyTaxAfterDiscount": false,
    "PrintStatus": "NeedToPrint",
    "EmailStatus": "NeedToSend",
    "BillEmail": {
      "Address": "Familiystore@intuit.com"
    },
    "Balance": 0,
    "domain": "QBO",
    "sparse": false,
    "Id": "156",
    "SyncToken": "0",
    "MetaData": {
      "CreateTime": "2015-07-24T10:32:45-07:00",
      "LastUpdatedTime": "2015-07-24T10:32:45-07:00"
    },
    "TxnDate": "2015-07-24",
    "CurrencyRef": {
      "value": "USD",
      "name": "United States Dollar"
    },
    "Line": [
      {
        "Id": "1",
        "LineNum": 1,
        "Amount": 100.00,
        "DetailType": "SalesItemLineDetail",
        "SalesItemLineDetail": {
          "ItemRef": {
            "value": "1",
            "name": "Services"
          },
          "UnitPrice": 100,
          "Qty": 1,
          "TaxCodeRef": {
            "value": "TAX"
          }
        }
      },
      {
        "Amount": 8.00,
        "DetailType": "TaxLineDetail",
        "TaxLineDetail": {
          "TaxRateRef": {
            "value": "3"
          },
          "PercentBased": true,
          "TaxPercent": 8,
          "NetAmountTaxable": 100.00
        }
      }
    ],
    "TxnTaxDetail": {
      "TxnTaxCodeRef": {
        "value": "2"
      },
      "TotalTax": 8.00,
      "TaxLine": [
        {
          "Amount": 8.00,
          "DetailType": "TaxLineDetail",
          "TaxLineDetail": {
            "TaxRateRef": {
              "value": "3"
            },
            "PercentBased": true,
            "TaxPercent": 8,
            "NetAmountTaxable": 100.00
          }
        }
      ]
    }
  },
  "time": "2015-07-24T10:32:44.899-07:00"
}
```

**Read**

*   **`GET /v3/company/<realmID>/salesreceipt/<salesreceiptID>`**
*   Retrieves a `SalesReceipt` object by `Id`.

*Response Example (JSON)* - Similar structure to the Create response, showing the details of the requested SalesReceipt.

**Update**

*   **`POST /v3/company/<realmID>/salesreceipt?operation=update`**
*   Updates a `SalesReceipt` object.

*Sparse Update:* Use `sparse=true` query parameter to update only specified fields. Requires `Id` and `SyncToken`.

*Request Body Example (JSON - Sparse Update)*

```json
{
   "Id": "156",
   "SyncToken": "0",
   "sparse": true,
   "PrivateNote": "Updated note for the sales receipt. Payment received.",
   "PaymentMethodRef": {
       "value": "2" // Changed to Check
   }
}
```

*Request Body Example (JSON - Full Update)* - Provide the entire SalesReceipt object with updated fields.

```json
{
  "Id": "156",
  "SyncToken": "1", // Use the latest SyncToken
  "Line": [
    {
      "Id": "1", // Must provide Line Id if updating existing lines
      "LineNum": 1,
      "Amount": 150.00, // Updated amount
      "DetailType": "SalesItemLineDetail",
      "SalesItemLineDetail": {
        "ItemRef": {
          "value": "1",
          "name": "Services"
        },
        "UnitPrice": 150, // Updated unit price
        "Qty": 1,
        "TaxCodeRef": {
          "value": "TAX"
        }
      }
    }
     // Tax line will be recalculated by QuickBooks
  ],
  "CustomerRef": {
    "value": "1"
  },
   "PrivateNote": "Full update example",
   // Include all other required/relevant fields from the original object
   "DepositToAccountRef": {
      "value": "45"
   },
   "PaymentMethodRef": {
      "value": "2"
   }
   // ... other fields ...
}
```

*Response Example (JSON)* - Returns the complete, updated SalesReceipt object with a new SyncToken.

**Delete**

*   **`POST /v3/company/<realmID>/salesreceipt?operation=delete`**
*   Deletes the specified `SalesReceipt` object. The object is permanently deleted and cannot be recovered.

*Request Body Example (JSON)*

```json
{
    "Id": "156",
    "SyncToken": "2" // Provide the latest SyncToken
}
```

*Response Example (JSON)*

```json
{
  "SalesReceipt": {
    "Id": "156",
    "SyncToken": "3", // New SyncToken after delete (object state is Deleted)
    "status": "Deleted", // May vary, often status indicates deletion
    "MetaData": {
        "CreateTime": "2015-07-24T10:32:45-07:00",
        "LastUpdatedTime": "2025-04-12T00:00:00-07:00" // Time of deletion
    }
    // Other fields might be minimal or absent
  },
  "time": "2025-04-12T00:00:00.123-07:00"
}
```
*Note:* Deleting transactions is generally discouraged in accounting. Voiding is often preferred.

**Void**

*   **`POST /v3/company/<realmID>/salesreceipt?operation=void`**
*   Voids the specified `SalesReceipt` object. A voided transaction is not deleted but its amount is set to zero, and it includes a note indicating it was voided.

*Request Body Example (JSON)*

```json
{
    "Id": "157",
    "SyncToken": "0" // Provide the latest SyncToken
}
```

*Response Example (JSON)* - Returns the SalesReceipt object with `TotalAmt` set to 0, a new `SyncToken`, and often a `PrivateNote` indicating the void action.

**Query**

*   **`GET /v3/company/<realmID>/query?query=<selectStatement>`**
*   Retrieves `SalesReceipt` objects based on the specified query criteria.

*Example Query*

```sql
SELECT * FROM SalesReceipt WHERE CustomerRef = '1' AND TotalAmt > 50.00 STARTPOSITION 1 MAXRESULTS 10
```

*Response Example (JSON)*

```json
{
  "QueryResponse": {
    "SalesReceipt": [
       // Array of SalesReceipt objects matching the query
       {
         "Id": "158",
         "SyncToken": "0",
         "TotalAmt": 108.00,
         // ... other fields ...
       }
    ],
    "startPosition": 1,
    "maxResults": 10,
    "totalCount": 1 // Total matching records found
  },
  "time": "2025-04-12T00:00:05.456-07:00"
}
```

**Send**

*   **`POST /v3/company/<realmID>/salesreceipt/<salesreceiptID>/send?sendTo=<email_address>`**
*   Sends the specified `SalesReceipt` via email.
*   If the `sendTo` query parameter is not provided, the email address from the `BillEmail` field of the SalesReceipt is used. If `BillEmail` is not set, the `PrimaryEmailAddr` of the associated `Customer` is used.

*Response Example (JSON)* - Returns the SalesReceipt object, potentially with an updated `EmailStatus` (e.g., `EmailSent`).

*(End of SalesReceipt Section)*

---

## 2. Customer

**(from `https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/customer`)**

# Customer

*   **`QuickBooks Online API Reference Guide > Accounting API > Entities (A-Z) > Customer`**

**Description**

The Customer object represents the customer entity in QuickBooks. QuickBooks Online companies have a list of customers. Customers are people or organizations that your business sells products or services to. Sales transactions, such as `Invoice` and `SalesReceipt` objects, are linked to customers. The Customer entity is also used to track prospects (potential customers). In QuickBooks Online Plus, customers can be organized into a hierarchy to represent jobs or sub-customers.

**Business Rules**

*   **Required:** `DisplayName` is required for the Create operation and must be unique across all `Customer`, `Vendor`, and `Employee` objects.
*   **Uniqueness:** Display names of `Customer`, `Vendor`, and `Employee` objects must be unique. The API returns an error message if a duplicate name is used.
*   **Sub-customers and jobs:** Customers can have parent-child relationships to track sub-customers or jobs. Create a hierarchical relationship by setting the `ParentRef` attribute to the parent customer's `Id`. The `Level` attribute indicates the hierarchical level of the customer (0 for top-level). Maximum hierarchy depth is 5 levels (0 through 4). The `Job` attribute should be set to `true` if the Customer object represents a job.
*   **Updates:** `SyncToken` is required for update operations. Sparse updates are supported using `sparse=true`. Set `Active=false` to make a customer inactive.

**Properties**

| Name                     | Type                                            | Description                                                                                                                                                                        | Filterable | Sortable | Max Length | Min Acc. Ver | Notes                                                                                                                                                                                                                                                                         |
| :----------------------- | :---------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- | :------- | :--------- | :----------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Id`                     | `String`                                        | Unique identifier for this object. Sort order is ASC by default.                                                                                                                   | Yes        | Yes      | 30         |              | System-assigned, immutable, unique identifier for the object.                                                                                                                                                                                                                 |
| `SyncToken`              | `String`                                        | Version number of the object. It is used to lock an object for use by one client at a time. As soon as an application modifies an object, its SyncToken is incremented.              | No         | No       | 50         |              | Provide the latest `SyncToken` value when doing sparse updates.                                                                                                                                                                                                               |
| `MetaData`               | [`ModificationMetaData`](#modificationmetadata) | Descriptive information about the entity read from the source accounting system.                                                                                                   | No         | No       |            |              | Includes creation and last updated times. See [MetaData](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/minor-versions#metadata).                                                                                                |
| `Title`                  | `String`                                        | Title of the person.                                                                                                                                                               | Yes        | No       | 15         |              | E.g., Mr., Mrs., Ms., Sir.                                                                                                                                                                                                                                    |
| `GivenName`              | `String`                                        | Given name or first name of the person.                                                                                                                                            | Yes        | No       | 100        |              |                                                                                                                                                                                                                                                                               |
| `MiddleName`             | `String`                                        | Middle name of the person.                                                                                                                                                         | Yes        | No       | 100        |              |                                                                                                                                                                                                                                                                               |
| `FamilyName`             | `String`                                        | Family name or last name of the person.                                                                                                                                            | Yes        | No       | 100        |              |                                                                                                                                                                                                                                                                               |
| `Suffix`                 | `String`                                        | Suffix of the name.                                                                                                                                                                | Yes        | No       | 10         |              | E.g., Jr., Sr., III.                                                                                                                                                                                                                                          |
| `DisplayName`            | `String`                                        | **Required.** Name of the customer as displayed in QuickBooks. Max 500 chars. Must be unique across all Customer, Vendor, and Employee objects. Whitespace is trimmed. Cannot be empty. | Yes        | Yes      | 500        |              | If the name contains a colon ":", the part after the last colon is interpreted as the sub-level name.                                                                                                                                                                           |
| `FullyQualifiedName`     | `String`                                        | Read only. Fully qualified name of the entity. Includes the name of the parent entity, if applicable, separated by colons. E.g., "Parent:Customer:Job1".                              | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `CompanyName`            | `String`                                        | Name of the company associated with the customer.                                                                                                                                  | Yes        | No       | 500        |              |                                                                                                                                                                                                                                                                               |
| `PrintOnCheckName`       | `String`                                        | Name of the customer to be printed on checks.                                                                                                                                      | Yes        | No       | 500        |              | Typically used more for Vendors, but available.                                                                                                                                                                                                                               |
| `Active`                 | `Boolean`                                       | If `true`, this customer is active. If `false`, the customer is inactive and hidden from lists. Default is `true`.                                                                   | Yes        | No       |            |              | Inactive customers cannot be used in new transactions.                                                                                                                                                                                                                          |
| `PrimaryPhone`           | [`TelephoneNumber`](#telephonenumber)           | Primary phone number.                                                                                                                                                              | Yes        | No       |            |              | Includes `FreeFormNumber` string.                                                                                                                                                                                                                                             |
| `AlternatePhone`         | [`TelephoneNumber`](#telephonenumber)           | Alternate phone number.                                                                                                                                                            | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `Mobile`                 | [`TelephoneNumber`](#telephonenumber)           | Mobile phone number.                                                                                                                                                               | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `Fax`                    | [`TelephoneNumber`](#telephonenumber)           | Fax number.                                                                                                                                                                        | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `PrimaryEmailAddr`       | [`EmailAddress`](#emailaddress)                 | Primary email address.                                                                                                                                                             | Yes        | No       |            |              | Includes `Address` string. Max 100 chars.                                                                                                                                                                                                                                     |
| `WebAddr`                | [`WebSiteAddress`](#websiteaddress)             | Website address.                                                                                                                                                                   | Yes        | No       |            |              | Includes `URI` string. Max 1000 chars.                                                                                                                                                                                                                                        |
| `DefaultTaxCodeRef`      | [`ReferenceType`](#referencetype)                 | Reference to the default [`TaxCode`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/taxcode) used for sales transactions for this customer.        | Yes        | No       |            |              | If `Taxable` is `true` and this is not provided, the default tax code for the company is used.                                                                                                                                                                              |
| `ShipMethodRef`          | [`ReferenceType`](#referencetype)                 | Reference to the preferred [`ShipMethod`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/shipmethod) for this customer.                      | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `SalesTermRef`           | [`ReferenceType`](#referencetype)                 | Reference to the default [`Term`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/term) (payment terms) for this customer.                     | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `CustomerTypeRef`        | [`ReferenceType`](#referencetype)                 | Reference to the [`CustomerType`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/customertype) for classifying the customer.               | Yes        | No       |            |              | Requires the Customer Type feature to be enabled.                                                                                                                                                                                                                             |
| `PaymentMethodRef`       | [`ReferenceType`](#referencetype)                 | Reference to the preferred [`PaymentMethod`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/paymentmethod) for this customer.           | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `BillAddr`               | [`PhysicalAddress`](#physicaladdress)             | Billing address.                                                                                                                                                                   | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `ShipAddr`               | [`PhysicalAddress`](#physicaladdress)             | Shipping address.                                                                                                                                                                  | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `Notes`                  | `String`                                        | Notes about the customer.                                                                                                                                                          | Yes        | No       | 4000       |              |                                                                                                                                                                                                                                                                               |
| `Job`                    | `Boolean`                                       | If `true`, this customer represents a job or sub-customer. Requires `ParentRef` to be set. If `false` (or null), this is a regular customer or a parent customer.             | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `BillWithParent`         | `Boolean`                                       | If `true`, invoices for this job/sub-customer should be billed with the parent customer. Relevant only if `Job` is `true`.                                                    | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `ParentRef`              | [`ReferenceType`](#referencetype)                 | Reference to the parent customer object. Required if `Job` is `true`. The referenced object must be a `Customer`.                                                              | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `Level`                  | `Integer`                                       | Read only. Hierarchical level of the customer (0 for top-level, 1 for direct sub-customer/job, etc.). Max level is 4.                                                        | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `Taxable`                | `Boolean`                                       | If `true`, sales to this customer are generally taxable. Default depends on company settings (usually `true` for US, `false` for Global).                                     | Yes        | No       |            |              | If `false`, the `DefaultTaxCodeRef` is set to a non-taxable default tax code.                                                                                                                                                                                                 |
| `Balance`                | `Decimal`                                       | Read only. The open balance amount orAR balance for the customer (money owed to the business). Does not include the balance of sub-customers/jobs.                              | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                               |
| `BalanceWithJobs`        | `Decimal`                                       | Read only. The open balance amount or AR balance for the customer, including the balances of all its sub-customers/jobs.                                                     | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                               |
| `CurrencyRef`            | [`ReferenceType`](#referencetype)                 | Reference to the [`Currency`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/currency) in which this customer's transactions are recorded. | Yes        | No       |            |              | Required if `MultiCurrency` is enabled for the company.                                                                                                                                                                                                                       |
| `PreferredDeliveryMethod`| `String`                                        | Preferred method for delivering sales forms (`Print`, `Email`, `None`).                                                                                                        | Yes        | No       |            |              |                                                                                                                                                                                                                                                                               |
| `ResaleNum`              | `String`                                        | Resale number or VAT registration number for tax exemption purposes.                                                                                                           | Yes        | No       | 30         |              | Label might vary by region (e.g., "Resale number" in US, "VAT registration number" in UK).                                                                                                                                                                             |
| `TaxExemptionReasonId`   | `String`                                        | Identifier for the reason the customer is tax-exempt. Available in CA, UK, AU editions only.                                                                                    | No         | No       |            | Minor Ver. 41| Reference to an `TaxExemption` entity. Requires minor version 41.                                                                                                                                                                                                             |
| `IsProject`              | `Boolean`                                       | Read only. `True` if the entity represents a project. A project is a special customer sub-type. Available in Plus and Advanced subscriptions. See [Projects](https://developer.intuit.com/app/developer/qbo/docs/projects). | Yes        | No       |            | Minor Ver. 67| Requires minor version 67.                                                                                                                                                                                                                                        |
| `BusinessNumber`         | `String`                                        | Business registration number. UK specific: VAT registration number. CA specific: Business number. FR specific: SIRET.                                                         | No         | No       | 100        | Minor Ver. 8 | Requires minor version 8.                                                                                                                                                                                                                                         |
| `GSTIN`                  | `String`                                        | India specific: GST Identification Number.                                                                                                                                 | No         | No       | 15         | Minor Ver. 11| Requires minor version 11.                                                                                                                                                                                                                                        |
| `GSTRegistrationType`    | `String`                                        | India specific: Type of GST registration.                                                                                                                                  | No         | No       |            | Minor Ver. 11| Values: `GST_REG_REG`, `GST_REG_COMP`, `GST_REG_UNREG`, `GST_REG_UNKNOWN`. Requires minor version 11.                                                                                                                                                                      |
| `PrimaryTaxIdentifier`   | `String`                                        | India specific: Primary Tax Identifier (PAN).                                                                                                                              | No         | No       | 255        | Minor Ver. 62| Requires minor version 62.                                                                                                                                                                                                                                        |

**Operations**

The `Customer` object supports the following operations:

**Create**

*   **`POST /v3/company/<realmID>/customer`**
*   Creates a `Customer` object. `DisplayName` is required.

*Request Body Example (JSON)*

```json
{
  "BillAddr": {
    "Line1": "123 Main Street",
    "City": "Mountain View",
    "Country": "USA",
    "CountrySubDivisionCode": "CA",
    "PostalCode": "94042"
  },
  "Notes": "Here are other details.",
  "DisplayName": "King Groceries",
  "PrimaryPhone": {
    "FreeFormNumber": "(650) 555-1111"
  },
  "PrimaryEmailAddr": {
    "Address": "info@kinggroceries.com"
  }
}
```

*Response Example (JSON)*

```json
{
  "Customer": {
    "Taxable": true,
    "BillAddr": {
      "Id": "65",
      "Line1": "123 Main Street",
      "City": "Mountain View",
      "Country": "USA",
      "CountrySubDivisionCode": "CA",
      "PostalCode": "94042"
    },
    "Notes": "Here are other details.",
    "Job": false,
    "BillWithParent": false,
    "Balance": 0,
    "BalanceWithJobs": 0,
    "CurrencyRef": {
      "value": "USD",
      "name": "United States Dollar"
    },
    "PreferredDeliveryMethod": "Print",
    "domain": "QBO",
    "sparse": false,
    "Id": "61",
    "SyncToken": "0",
    "MetaData": {
      "CreateTime": "2014-09-11T10:18:20-07:00",
      "LastUpdatedTime": "2014-09-11T10:18:20-07:00"
    },
    "DisplayName": "King Groceries",
    "PrimaryPhone": {
      "FreeFormNumber": "(650) 555-1111"
    },
    "PrimaryEmailAddr": {
      "Address": "info@kinggroceries.com"
    },
    "PrintOnCheckName": "King Groceries",
    "Active": true,
    "Level": 0
  },
  "time": "2014-09-11T10:18:19.913-07:00"
}
```

**Read**

*   **`GET /v3/company/<realmID>/customer/<customerID>`**
*   Retrieves a `Customer` object by `Id`.

*Response Example (JSON)* - Similar structure to the Create response, showing the details of the requested Customer.

**Update**

*   **`POST /v3/company/<realmID>/customer?operation=update`**
*   Updates a `Customer` object. `Id` and `SyncToken` are required.

*Sparse Update:* Use `sparse=true` query parameter to update only specified fields.

*Request Body Example (JSON - Sparse Update)*

```json
{
   "Id": "61",
   "SyncToken": "0",
   "sparse": true,
   "Notes": "Updated customer notes via sparse update.",
   "PrimaryPhone": { "FreeFormNumber": "650-555-8888" }
}
```

*Request Body Example (JSON - Full Update)* - Provide the entire Customer object with updated fields.

```json
{
  "Id": "61",
  "SyncToken": "1", // Use latest SyncToken
  "Taxable": true,
  "BillAddr": {
    "Id": "65", // Provide address ID if updating existing address
    "Line1": "456 Market St", // Updated address line
    "City": "San Francisco",
    "Country": "USA",
    "CountrySubDivisionCode": "CA",
    "PostalCode": "94105"
  },
  "Notes": "Full update with new address.",
  "Job": false,
  "BillWithParent": false,
  "Balance": 0, // Balances are read-only, ignored in update
  "BalanceWithJobs": 0,
  "CurrencyRef": {
    "value": "USD",
    "name": "United States Dollar"
  },
  "PreferredDeliveryMethod": "Email", // Updated delivery method
  "DisplayName": "King Groceries Inc", // Updated display name
  "PrimaryPhone": {
    "FreeFormNumber": "(415) 555-2222"
  },
  "PrimaryEmailAddr": {
    "Address": "billing@kinggroceries.com" // Updated email
  },
  "PrintOnCheckName": "King Groceries Incorporated",
  "Active": true,
  "Level": 0,
  "CompanyName": "King Groceries Incorporated" // Added company name
}
```

*Response Example (JSON)* - Returns the complete, updated Customer object with a new SyncToken.

**Query**

*   **`GET /v3/company/<realmID>/query?query=<selectStatement>`**
*   Retrieves `Customer` objects based on the specified query criteria.

*Example Query*

```sql
SELECT * FROM Customer WHERE Active = true AND FamilyName LIKE 'Smi%' ORDER BY DisplayName
```

*Response Example (JSON)*

```json
{
  "QueryResponse": {
    "Customer": [
       // Array of Customer objects matching the query
       {
         "Id": "5",
         "SyncToken": "2",
         "DisplayName": "Smith, John",
         "FamilyName": "Smith",
         "GivenName": "John",
         "Active": true,
         // ... other fields ...
       }
    ],
    "startPosition": 1,
    "maxResults": 1, // Example: only retrieved one record
    "totalCount": 1 // Total matching records found
  },
  "time": "2025-04-12T00:00:10.111-07:00"
}
```

*(End of Customer Section)*

---

## 3. Account

**(from `https://developer.intuit.com/app/developer/qbo/docs/api/accounting/most-commonly-used/account`)**

# Account

*   **`QuickBooks Online API Reference Guide > Accounting API > Most Commonly Used Entities > Account`**

**Description**

An Account object represents a financial account in the QuickBooks company's chart of accounts. Accounts are used to categorize the company's financial transactions on reports. Every transaction in QuickBooks must affect at least two accounts. The Account object allows the developer to manipulate the chart of accounts list. It is referenced by most transaction objects.

**Business Rules**

*   **Required:** `Name` and `AccountType` are required fields during creation.
*   **Uniqueness:** `Name` must be unique. The fully qualified name, which includes the parent hierarchy (e.g., `Parent:SubAccount`), must be unique across all accounts.
*   **AccountType vs AccountSubType:** `AccountSubType` must be a valid subtype for the specified `AccountType`. See [Account types and subtypes](https://developer.intuit.com/app/developer/qbo/docs/learn/chart-of-accounts#account-types-and-subtypes) for details.
*   **Updates:** `SyncToken` is required. Sparse update is supported. Use `sparse=true`.
*   **Sub-accounts:** Use `ParentRef` to create sub-accounts. Maximum hierarchy depth is 5 levels (0-4).
*   **Active status:** Setting `Active` to `false` makes the account inactive. Inactive accounts with non-zero balances cannot be made inactive via the API.
*   **Deleting:** An account cannot be deleted if it is referenced by other objects (transactions, items, etc.). It must first be made inactive. Deleting may be possible via UI under specific conditions (e.g., merging).

**Properties**

| Name                          | Type                                            | Description                                                                                                                                                                              | Filterable | Sortable | Max Length | Min Acc. Ver | Notes                                                                                                                                                                                                                                                                                                                                                     |
| :---------------------------- | :---------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- | :------- | :--------- | :----------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `Id`                          | `String`                                        | Unique identifier for this object. Sort order is ASC by default.                                                                                                                         | Yes        | Yes      | 30         |              | System-assigned, immutable, unique identifier for the object.                                                                                                                                                                                                                                                                                                 |
| `SyncToken`                   | `String`                                        | Version number of the object. It is used to lock an object for use by one client at a time. As soon as an application modifies an object, its SyncToken is incremented.                    | No         | No       | 50         |              | Provide the latest `SyncToken` value when doing sparse updates.                                                                                                                                                                                                                                                                                                 |
| `MetaData`                    | [`ModificationMetaData`](#modificationmetadata) | Descriptive information about the entity read from the source accounting system.                                                                                                         | No         | No       |            |              | Includes creation and last updated times. See [MetaData](https://developer.intuit.com/app/developer/qbo/docs/learn/explore-the-quickbooks-online-api/minor-versions#metadata).                                                                                                                                                                                 |
| `Name`                        | `String`                                        | **Required.** User-visible name for the account. Max 100 chars. Must be unique. Cannot contain colon (:). Whitespace trimmed.                                                            | Yes        | Yes      | 100        |              | If the account is a sub-account, the name does not include the parent hierarchy.                                                                                                                                                                                                                                                                              |
| `FullyQualifiedName`          | `String`                                        | Read only. Fully qualified name of the entity. Includes the name of the parent entity, if applicable, separated by colons. E.g., "Checking" or "Expenses:Auto:Fuel".                   | Yes        | No       |            |              | System-calculated based on `Name` and `ParentRef`.                                                                                                                                                                                                                                                                                            |
| `Active`                      | `Boolean`                                       | If `true`, this account is active. If `false`, the account is inactive and hidden from lists. Default is `true`.                                                                          | Yes        | No       |            |              | Cannot make inactive if `CurrentBalance` is non-zero.                                                                                                                                                                                                                                                                                         |
| `Classification`              | `AccountClassificationEnum`                     | Read only. Classification assigned by the system based on `AccountType`.                                                                                                                 | Yes        | No       |            |              | Values: `Asset`, `Equity`, `Expense`, `Liability`, `Revenue`.                                                                                                                                                                                                                                                                                                 |
| `AccountType`                 | `AccountTypeEnum`                               | **Required.** The primary type of the account, which determines its placement on financial statements.                                                                                   | Yes        | No       |            |              | Valid values (see linked doc for full list): `Bank`, `Accounts Receivable`, `Other Current Asset`, `Fixed Asset`, `Other Asset`, `Accounts Payable`, `Credit Card`, `Other Current Liability`, `Long Term Liability`, `Equity`, `Income`, `Cost of Goods Sold`, `Expense`, `Other Income`, `Other Expense`, `Non-Posting`. |
| `AccountSubType`              | `String`                                        | Detailed classification for the account, providing more specificity than `AccountType`. Must be a valid subtype for the chosen `AccountType`.                                             | Yes        | No       | 100        |              | Examples: `Checking`, `Savings` (for Bank); `AccountsReceivable` (for AR); `AdvertisingPromotional`, `OfficeSupplies` (for Expense). See [Account types and subtypes](https://developer.intuit.com/app/developer/qbo/docs/learn/chart-of-accounts#account-types-and-subtypes) for the full list.                                                               |
| `AcctNum`                     | `String`                                        | Account number, often used for bank accounts. Max 7 chars if Account Numbers feature is enabled in company settings, otherwise max 100 chars.                                             | Yes        | Yes      | 100        |              |                                                                                                                                                                                                                                                                                                                                                               |
| `CurrentBalance`              | `Decimal`                                       | Read only. The current balance of the account in the company's home currency. Derived from transactions associated with this account.                                                   | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                                                                                                               |
| `CurrentBalanceWithSubAccounts`| `Decimal`                                       | Read only. The current balance of the account plus balances of all its sub-accounts in the company's home currency.                                                                      | Yes        | Yes      |            |              |                                                                                                                                                                                                                                                                                                                                                               |
| `ParentRef`                   | [`ReferenceType`](#referencetype)                 | Reference to the parent account object. If this attribute is null or empty, the account is a top-level account.                                                                         | Yes        | No       |            |              | Used to create sub-accounts. The referenced object must be an `Account`.                                                                                                                                                                                                                                                                          |
| `SubAccount`                  | `Boolean`                                       | Read only. `True` if the account is a sub-account (i.e., `ParentRef` is specified).                                                                                                      | Yes        | No       |            |              |                                                                                                                                                                                                                                                                                                                                                               |
| `TxnLocationType`             | `String`                                        | France-specific classification indicating the location of the transaction.                                                                                                               | No         | No       |            | Minor Ver. 8 | Values: `WithinFrance`, `OutsideFranceWithEU`, `OutsideEU`. Requires minor version 8.                                                                                                                                                                                                                                                                 |
| `Description`                 | `String`                                        | User-provided description for the account.                                                                                                                                             | Yes        | No       | 1000       |              |                                                                                                                                                                                                                                                                                                                                                               |
| `CurrencyRef`                 | [`ReferenceType`](#referencetype)                 | Reference to the [`Currency`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/currency) associated with the account. Required for non-home currency Bank or Credit Card accounts if MultiCurrency is enabled. | Yes        | No       |            |              | If not specified for other account types, defaults to home currency.                                                                                                                                                                                                                                                                          |
| `TaxCodeRef`                  | [`ReferenceType`](#referencetype)                 | Default [`TaxCode`](https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/taxcode) associated with this account. Used in specific transactions like Journal Entries. | Yes        | No       |            |              | For example, can associate a default VAT code with an expense account.                                                                                                                                                                                                                                                                          |
| `OnlineBankingEnabled`        | `Boolean`                                       | Read only via API. Indicates if the account is enabled for QuickBooks Online Banking connection.                                                                                         | No         | No       |            | Minor Ver. 37| Requires minor version 37.                                                                                                                                                                                                                                                                                                                    |
| `AccountAlias`                | `String`                                        | An alias or alternate identifier for the account.                                                                                                                                      | Yes        | No       | 100        | Minor Ver. 55| Requires minor version 55.                                                                                                                                                                                                                                                                                                                    |

**Account Types and Subtypes**

*(Note: This is a representative list, refer to the linked Intuit documentation for the definitive, exhaustive list for each AccountType)*

*   **Assets:**
    *   `Bank`: Checking, Savings, CashOnHand, MoneyMarket, ...
    *   `Accounts Receivable`: AccountsReceivable
    *   `Other Current Asset`: AllowanceForBadDebts, UndepositedFunds, PrepaidExpenses, ...
    *   `Fixed Asset`: Buildings, FurnitureAndFixtures, Land, MachineryAndEquipment, Vehicles, AccumulatedDepreciation, ...
    *   `Other Asset`: Goodwill, Licenses, SecurityDeposits, ...
*   **Liabilities & Equity:**
    *   `Accounts Payable`: AccountsPayable
    *   `Credit Card`: CreditCard
    *   `Other Current Liability`: LoanPayable, PayrollTaxPayable, SalesTaxPayable, ...
    *   `Long Term Liability`: NotesPayable, ShareholderNotesPayable, ...
    *   `Equity`: OpeningBalanceEquity, RetainedEarnings, CommonStock, OwnerEquity, PartnerContributions, ...
*   **Income & Expenses:**
    *   `Income`: SalesOfProductIncome, ServiceFeeIncome, NonProfitIncome, ...
    *   `Cost of Goods Sold`: CostOfGoodsSold, FreightAndDeliveryCost, SuppliesMaterialsCogs, ...
    *   `Expense`: AdvertisingPromotional, Auto, BankCharges, DuesSubscriptions, Insurance, LegalProfessionalFees, OfficeGeneralAdministrativeExpenses, PayrollExpenses, RentOrLeaseOfBuildings, RepairMaintenance, SuppliesMaterials, Utilities, Travel, ...
    *   `Other Income`: InterestEarned, DividendIncome, OtherMiscellaneousIncome, ...
    *   `Other Expense`: GasAndFuel, HomeOffice, PenaltiesSettlements, ParkingAndTolls, ...

**Operations**

The `Account` object supports the following operations:

**Create**

*   **`POST /v3/company/<realmID>/account`**
*   Creates an `Account` object. `Name`, `AccountType`, and usually `AccountSubType` are required.

*Request Body Example (JSON - Expense Account)*

```json
{
  "Name": "Office Expenses",
  "AccountSubType": "OfficeGeneralAdministrativeExpenses",
  "AccountType": "Expense",
  "Description": "General office operating expenses"
}
```

*Request Body Example (JSON - Bank Account)*

```json
{
  "Name": "Business Checking",
  "AccountSubType": "Checking",
  "AccountType": "Bank",
  "AcctNum": "123456789",
  "CurrencyRef": { // Required only if MultiCurrency is ON and not home currency
     "value": "USD"
  }
}
```

*Request Body Example (JSON - Sub-Account)*

```json
{
  "Name": "Fuel",
  "AccountSubType": "Auto", // Or GasAndFuel depending on preference/region
  "AccountType": "Expense",
  "ParentRef": {
    "value": "80" // ID of the parent "Automobile Expense" account
  },
  "SubAccount": true // Explicitly setting this is good practice
}
```

*Response Example (JSON)*

```json
{
  "Account": {
    "Name": "Office Expenses",
    "SubAccount": false,
    "FullyQualifiedName": "Office Expenses",
    "Active": true,
    "Classification": "Expense",
    "AccountType": "Expense",
    "AccountSubType": "OfficeGeneralAdministrativeExpenses",
    "Description": "General office operating expenses",
    "CurrentBalance": 0,
    "CurrentBalanceWithSubAccounts": 0,
    "CurrencyRef": {
      "value": "USD",
      "name": "United States Dollar"
    },
    "domain": "QBO",
    "sparse": false,
    "Id": "139",
    "SyncToken": "0",
    "MetaData": {
      "CreateTime": "2015-07-28T15:19:46-07:00",
      "LastUpdatedTime": "2015-07-28T15:19:46-07:00"
    }
  },
  "time": "2015-07-28T15:19:46.141-07:00"
}
```

**Read**

*   **`GET /v3/company/<realmID>/account/<accountID>`**
*   Retrieves an `Account` object by `Id`.

*Response Example (JSON)* - Similar structure to the Create response, showing the details of the requested Account.

**Update**

*   **`POST /v3/company/<realmID>/account?operation=update`**
*   Updates an `Account` object. `Id` and `SyncToken` are required.

*Sparse Update:* Use `sparse=true` query parameter to update only specified fields. Cannot update `AccountType` or `AccountSubType` if the account has transactions associated with it. Cannot make inactive if balance is non-zero.

*Request Body Example (JSON - Sparse Update)*

```json
{
   "Id": "139",
   "SyncToken": "0",
   "sparse": true,
   "Description": "Updated: General office and administrative expenses",
   "AcctNum": "ACCT-OE-001" // Adding an account number
}
```

*Request Body Example (JSON - Full Update)* - Provide the entire Account object with updated fields.

```json
{
  "Id": "139",
  "SyncToken": "1", // Use latest SyncToken
  "Name": "Office Expenses (Admin)", // Updated name
  "SubAccount": false,
  "Active": true,
  "Classification": "Expense", // Read-only, ignored in update
  "AccountType": "Expense", // Cannot change if transactions exist
  "AccountSubType": "OfficeGeneralAdministrativeExpenses", // Cannot change if transactions exist
  "Description": "Updated: General office and administrative expenses (Full Update)",
  "AcctNum": "ACCT-OE-001",
  "CurrentBalance": 0, // Read-only, ignored
  "CurrentBalanceWithSubAccounts": 0, // Read-only, ignored
  "CurrencyRef": {
    "value": "USD",
    "name": "United States Dollar"
  }
  // Include MetaData from read if needed by application logic, but it's ignored by API
}
```

*Response Example (JSON)* - Returns the complete, updated Account object with a new SyncToken.

**Query**

*   **`GET /v3/company/<realmID>/query?query=<selectStatement>`**
*   Retrieves `Account` objects based on the specified query criteria.

*Example Query*

```sql
SELECT * FROM Account WHERE AccountType = 'Bank' AND Active = true MAXRESULTS 5
```

*Example Query (Find sub-accounts)*

```sql
SELECT * FROM Account WHERE ParentRef = '80' // Find direct children of account ID 80
```

*Example Query (Find by name)*

```sql
SELECT * FROM Account WHERE FullyQualifiedName = 'Expenses:Auto:Fuel'
```

*Response Example (JSON)*

```json
{
  "QueryResponse": {
    "Account": [
      // Array of Account objects matching the query
      {
        "Id": "45",
        "SyncToken": "3",
        "Name": "Checking",
        "FullyQualifiedName": "Checking",
        "AccountType": "Bank",
        "AccountSubType": "Checking",
        "Active": true,
        // ... other fields ...
      },
      {
        "Id": "46",
        "SyncToken": "1",
        "Name": "Savings",
        "FullyQualifiedName": "Savings",
        "AccountType": "Bank",
        "AccountSubType": "Savings",
        "Active": true,
        // ... other fields ...
      }
    ],
    "startPosition": 1,
    "maxResults": 2,
    "totalCount": 2
  },
  "time": "2025-04-12T00:00:15.789-07:00"
}
```

**Delete**

*   Accounts cannot be deleted directly via the API if referenced elsewhere.
*   To remove an account from use, perform an **Update** operation setting `Active = false`. Ensure the account balance is zero first.

*(End of Account Section)*

Okay, I will extract the content from the five requested URLs using the scraping tool. This will likely be a large amount of text, including code examples and detailed explanations.

---

## 1. OAuth 2.0 (Full Extraction)

**(from `https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/oauth-2.0`)**

# OAuth 2.0

*   **`QuickBooks Online API Reference Guide > Develop > Authentication and authorization > OAuth 2.0`**

**Overview**

OAuth 2.0 is the industry-standard protocol for authorization used by Intuit APIs. This implementation uses the Authorization Code Grant flow. Your app must integrate with the OAuth 2.0 framework to get user consent to access their QuickBooks company data.

**Key Concepts**

*   **Authorization Code Grant:** The standard OAuth 2.0 flow used by Intuit. It involves redirecting the user to Intuit's authorization server, obtaining an authorization code, and then exchanging that code for access and refresh tokens.
*   **Access Token:** A short-lived token (typically 60 minutes) that grants your app permission to make API calls on behalf of the user. It must be included in the `Authorization` header of each API request.
*   **Refresh Token:** A long-lived token (typically 100 days, refreshed with each use) used to obtain new access tokens when the current one expires, without requiring the user to go through the authorization flow again. Store refresh tokens securely.
*   **Scopes:** Define the specific permissions your app is requesting (e.g., `com.intuit.quickbooks.accounting` for QuickBooks Online API access, `openid`, `profile`, `email`, `phone`, `address` for user info).
*   **Client ID & Client Secret:** Credentials unique to your app, obtained from the Intuit Developer Portal. Used to identify your app during the OAuth flow. Keep the Client Secret confidential.
*   **Redirect URI:** The URL in your application where Intuit redirects the user after they grant or deny authorization. Must be pre-registered in the Intuit Developer Portal and use HTTPS.
*   **Authorization Code:** A temporary code obtained after successful user authorization. Exchanged for access and refresh tokens. Valid for 5 minutes.
*   **CSRF Token (State):** A recommended security measure to prevent Cross-Site Request Forgery. Generate a unique, unguessable string, send it in the authorization request (`state` parameter), and verify it matches when the user is redirected back to your app.

**The OAuth 2.0 Flow (Authorization Code Grant)**

1.  **Construct the Authorization URL:** Your app creates a URL pointing to Intuit's authorization endpoint, including parameters like `client_id`, `response_type=code`, `scope`, `redirect_uri`, and `state`.
2.  **Redirect User:** Redirect the user's browser to the constructed URL.
3.  **User Authentication & Consent:** Intuit authenticates the user (if not already logged in) and presents them with a consent screen detailing the permissions (scopes) your app is requesting.
4.  **User Grants Authorization:** If the user clicks "Connect" or "Authorize", Intuit redirects their browser back to your specified `redirect_uri`.
5.  **Receive Authorization Code:** The redirect includes the temporary `code` and the `state` parameter you originally sent. Your app should verify the `state` parameter matches the one sent in step 1 to prevent CSRF attacks. The `realmId` (QuickBooks company ID) is also included in the redirect parameters.
6.  **Exchange Code for Tokens:** Your app makes a secure, server-to-server POST request to Intuit's token endpoint. This request includes the `grant_type=authorization_code`, the received `code`, your `client_id`, `client_secret`, and the `redirect_uri`. The request requires Basic Authentication (`Authorization: Basic <Base64Encoded(client_id:client_secret)>`).
7.  **Receive Tokens:** Intuit validates the request and responds with a JSON payload containing the `access_token`, `refresh_token`, `expires_in` (access token lifetime in seconds), `x_refresh_token_expires_in` (refresh token lifetime in seconds), and `token_type` (Bearer).
8.  **Store Tokens Securely:** Securely store the `access_token`, `refresh_token`, and `realmId` associated with the user/company connection. Refresh tokens are sensitive and should be encrypted at rest.
9.  **Make API Calls:** Include the `access_token` in the `Authorization: Bearer <access_token>` header of your QuickBooks API requests, along with the `Accept: application/json` header.
10. **Refresh Access Token:** When the access token expires (or is about to expire), use the `refresh_token` to get a new access token and refresh token pair. Make a POST request to the token endpoint with `grant_type=refresh_token` and the current `refresh_token`. Store the *new* refresh token returned in the response, as refresh tokens may rotate.

**Endpoints**

*   **Sandbox:**
    *   Authorization Endpoint: `https://sandbox-appcenter.intuit.com/connect/oauth2`
    *   Token Endpoint: `https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer`
    *   User Info Endpoint: `https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo`
    *   Revoke Endpoint: `https://developer.api.intuit.com/v2/oauth2/tokens/revoke` (Uses production URL even for sandbox tokens)
    *   JWKS URI: `https://oauth.platform.intuit.com/op/v1/jwks`
*   **Production:**
    *   Authorization Endpoint: `https://appcenter.intuit.com/connect/oauth2`
    *   Token Endpoint: `https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer`
    *   User Info Endpoint: `https://accounts.platform.intuit.com/v1/openid_connect/userinfo`
    *   Revoke Endpoint: `https://developer.api.intuit.com/v2/oauth2/tokens/revoke`
    *   JWKS URI: `https://oauth.platform.intuit.com/op/v1/jwks`

**Scopes**

*   `com.intuit.quickbooks.accounting`: Access QuickBooks Online Accounting API (required for QBO API calls).
*   `com.intuit.quickbooks.payment`: Access QuickBooks Payments API.
*   `openid`: Required for OpenID Connect. Returns an ID token.
*   `profile`: Request access to user's default profile claims.
*   `email`: Request access to user's email address.
*   `phone`: Request access to user's phone number.
*   `address`: Request access to user's physical address.
*   `revoke`: Special scope used *only* when calling the revoke endpoint.

**Implementation Details**

**Step 1: Prepare the Authorization Request**

Construct the URL:

```
// Sandbox
https://sandbox-appcenter.intuit.com/connect/oauth2?client_id=<Your_Client_ID>&response_type=code&scope=<ScopesSeparatedBySpace>&redirect_uri=<Your_Encoded_Redirect_URI>&state=<Your_CSRF_Token>

// Production
https://appcenter.intuit.com/connect/oauth2?client_id=<Your_Client_ID>&response_type=code&scope=<ScopesSeparatedBySpace>&redirect_uri=<Your_Encoded_Redirect_URI>&state=<Your_CSRF_Token>
```

Example Scopes: `com.intuit.quickbooks.accounting openid profile email`

**Step 2 & 3: Redirect User & Obtain Consent**

Redirect the user's browser to the URL constructed above. The user logs into Intuit (if needed) and sees the consent screen.

**Step 4 & 5: Handle the Redirect & Get Authorization Code**

The user is redirected back to your `redirect_uri`. Extract parameters:

`https://<Your_Redirect_URI>/?code=<Authorization_Code>&state=<Your_CSRF_Token>&realmId=<Company_ID>`

Verify the received `state` matches the one you stored for the user session. If it matches, proceed. If not, abort the process (potential CSRF attack). Store the `realmId`.

**Step 6: Exchange Authorization Code for Tokens**

Make a POST request to the token endpoint:

*   URL: (Sandbox or Production token endpoint)
*   Method: `POST`
*   Headers:
    *   `Accept: application/json`
    *   `Content-Type: application/x-www-form-urlencoded`
    *   `Authorization: Basic <Base64Encode(Your_Client_ID:Your_Client_Secret)>`
*   Body (form-urlencoded):
    `grant_type=authorization_code&code=<Authorization_Code>&redirect_uri=<Your_Encoded_Redirect_URI>`

**Step 7: Receive and Store Tokens**

The response body will be JSON:

```json
{
    "x_refresh_token_expires_in": 8709189, // Seconds until refresh token expires (approx 100 days)
    "refresh_token": "...",
    "access_token": "...",
    "token_type": "bearer",
    "expires_in": 3600, // Seconds until access token expires (1 hour)
    "id_token": "..." // Only present if 'openid' scope was requested
}
```

Store `access_token`, `refresh_token`, `realmId`, and expiration times securely.

**Step 9: Make API Calls**

Include the access token in requests:

```
GET /v3/company/<realmId>/companyinfo/<realmId> HTTP/1.1
Host: sandbox-quickbooks.api.intuit.com (or quickbooks.api.intuit.com)
Accept: application/json
Authorization: Bearer <access_token>
```

**Step 10: Refreshing Tokens**

Make a POST request to the token endpoint *before* the access token expires:

*   URL: (Sandbox or Production token endpoint)
*   Method: `POST`
*   Headers:
    *   `Accept: application/json`
    *   `Content-Type: application/x-www-form-urlencoded`
    *   `Authorization: Basic <Base64Encode(Your_Client_ID:Your_Client_Secret)>`
*   Body (form-urlencoded):
    `grant_type=refresh_token&refresh_token=<Current_Refresh_Token>`

Response JSON will contain a *new* `access_token` and a *new* `refresh_token`:```json
{
    "x_refresh_token_expires_in": 8708739, // New expiry for the new refresh token
    "refresh_token": "...", // *** NEW Refresh Token ***
    "access_token": "...", // *** NEW Access Token ***
    "token_type": "bearer",
    "expires_in": 3600
}
```

**Important:** Always store the *new* refresh token returned from a refresh operation.

**Revoking Tokens**

To explicitly disconnect a user's connection (e.g., user clicks "Disconnect" in your app):

Make a POST request to the revoke endpoint:

*   URL: `https://developer.api.intuit.com/v2/oauth2/tokens/revoke` (Same for Sandbox/Prod)
*   Method: `POST`
*   Headers:
    *   `Accept: application/json`
    *   `Content-Type: application/x-www-form-urlencoded`
    *   `Authorization: Basic <Base64Encode(Your_Client_ID:Your_Client_Secret)>`
*   Body (form-urlencoded):
    `token=<Refresh_Token_Or_Access_Token_To_Revoke>`

A successful revocation returns HTTP 200 OK. This invalidates both the access and refresh tokens associated with the provided token.

**Security Considerations**

*   **HTTPS:** All communication, including your `redirect_uri`, must use HTTPS.
*   **CSRF Protection:** Use the `state` parameter.
*   **Client Secret:** Keep your Client Secret confidential. Do not embed it in client-side code.
*   **Token Storage:** Store refresh tokens securely (encrypted at rest). Access tokens can be stored in memory or session storage for their short lifetime but should still be protected.
*   **Redirect URI Validation:** Use exact string matching for redirect URIs. Avoid wildcards. Register all valid URIs.
*   **Token Validation (OpenID Connect):** If using OpenID Connect (`openid` scope), validate the received `id_token` according to the OpenID Connect specification (check signature using JWKS, issuer, audience, nonce, expiry).

**OpenID Connect**

Intuit's OAuth 2.0 implementation supports OpenID Connect for user authentication and retrieving user profile information. Request the `openid` scope along with other scopes (`profile`, `email`, etc.). The response to the token exchange request will include an `id_token` (a JSON Web Token - JWT). You can validate this JWT and extract user claims. You can also call the UserInfo endpoint using the access token to retrieve user information.

*User Info Endpoint Call:*

```
GET /v1/openid_connect/userinfo HTTP/1.1
Host: sandbox-accounts.platform.intuit.com (or accounts.platform.intuit.com)
Accept: application/json
Authorization: Bearer <access_token>
```

Response JSON contains user claims based on requested scopes.

**Libraries and SDKs**

Intuit provides official and community-supported SDKs and libraries for various platforms (Java, .NET, PHP, Python, Node.js, Ruby) that handle much of the OAuth 2.0 complexity. Check the Intuit Developer website for available libraries.

*(End of OAuth 2.0 Section)*

---

## 2. Authentication and Authorization FAQ (Full Extraction)

**(from `https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/faq`)**

# Authentication and Authorization FAQ

*   **`QuickBooks Online API Reference Guide > Develop > Authentication and authorization > FAQ`**

This page answers frequently asked questions about implementing OAuth 2.0 and OpenID Connect for Intuit APIs.

**OAuth 2.0**

**Q: Which OAuth flow does Intuit support?**
A: Intuit supports the OAuth 2.0 Authorization Code Grant flow. See [OAuth 2.0](https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/oauth-2.0) for details.

**Q: How long does an access token last?**
A: Access tokens expire after 60 minutes (3600 seconds).

**Q: How long does a refresh token last?**
A: Refresh tokens expire after 100 days (currently about 8.7 million seconds). The 100-day expiration timer resets *every time* the refresh token is used to obtain a new access token. If a refresh token is not used within 100 days, it will expire permanently.

**Q: What happens if a refresh token expires?**
A: If a refresh token expires, you cannot use it to get a new access token. The user must go through the OAuth 2.0 authorization flow again to re-authorize your application and obtain new access and refresh tokens.

**Q: Should I store the refresh token? How should I store it?**
A: Yes, you *must* securely store the refresh token for each user connection. Refresh tokens are sensitive credentials. Store them encrypted at rest in your database or secure storage system. Do *not* store them in client-side code or insecure locations.

**Q: Do refresh tokens change?**
A: Yes. When you successfully use a refresh token to get a new access token, the response will contain *both* a new access token and a *new* refresh token. You **must** save this new refresh token, replacing the one you just used. This is a security feature called refresh token rotation.

**Q: What are scopes and which ones do I need?**
A: Scopes define the permissions your app requests. You need:
    *   `com.intuit.quickbooks.accounting` to access QuickBooks Online Accounting API data.
    *   `com.intuit.quickbooks.payment` for QuickBooks Payments API.
    *   `openid` if you need to authenticate the user via OpenID Connect and receive an `id_token`.
    *   `profile`, `email`, `phone`, `address` to request specific user information (require `openid`).
Separate scopes with spaces in the authorization request (e.g., `scope=com.intuit.quickbooks.accounting openid email`).

**Q: What is the `realmId` (Company ID)? Where do I get it?**
A: The `realmId` is the unique identifier for a QuickBooks company file. It is returned as a query parameter (`realmId=...`) in the redirect back to your application after the user authorizes the connection (Step 5 of the OAuth flow). You must store this `realmId` along with the tokens, as it's required in the path of most QuickBooks API calls (e.g., `/v3/company/<realmId>/customer`).

**Q: Why do I need a `redirect_uri`? What are the requirements?**
A: The `redirect_uri` is the callback URL in your application where Intuit sends the user after they authorize (or deny) your app.
    *   It *must* use HTTPS.
    *   It *must* exactly match one of the Redirect URIs registered for your app in the Intuit Developer Portal.
    *   No wildcards or IP addresses are allowed (except `localhost` for development).
    *   It must be URL-encoded when included as a query parameter in the authorization request.

**Q: What is the `state` parameter used for?**
A: The `state` parameter is crucial for preventing Cross-Site Request Forgery (CSRF) attacks. Generate a unique, securely random, and non-guessable string for each authorization request. Store it temporarily (e.g., in the user's session). When the user is redirected back, compare the `state` parameter returned by Intuit with the value you stored. If they don't match, reject the request.

**Q: How do I handle multiple QuickBooks companies for one user?**
A: A single Intuit user account can manage multiple QuickBooks company files. When a user connects, they choose *one* specific company to authorize for your app. Each connection results in a unique `realmId` and a corresponding set of access/refresh tokens. If a user wants to connect a second company, they must go through the OAuth flow again, selecting the other company during authorization. Your application needs to store tokens and `realmId` pairs distinctly for each connection, even if they belong to the same Intuit user login.

**Q: How do I revoke a user's connection?**
A: Use the Revoke endpoint. Make a POST request with the access or refresh token you want to invalidate. See [OAuth 2.0 Revoke Endpoint](https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/oauth-2.0#revoke-tokens). This invalidates both the access and refresh tokens. You should then delete the stored tokens and `realmId` for that connection on your end.

**Q: What does the "Connect to QuickBooks" button do?**
A: This is the standard UI element users click to initiate the OAuth 2.0 flow from your application. Clicking it should trigger Step 1: Constructing the Authorization URL and redirecting the user (Step 2). Intuit provides design guidelines and button assets.

**Q: What are the Sandbox and Production environments?**
A:
    *   **Sandbox:** A testing environment with sample company data. Use it during development. Use sandbox keys and sandbox endpoints. Sandbox companies can be reset.
    *   **Production:** The live environment where real user data resides. Use production keys and production endpoints. Go through the app assessment process before getting production keys.

**Q: Can I use the same tokens for Sandbox and Production?**
A: No. Sandbox keys/tokens work only with sandbox endpoints and sandbox companies. Production keys/tokens work only with production endpoints and real user companies.

**Q: What is the Base64 encoding for the Authorization header in token requests?**
A: When exchanging the code for tokens or refreshing tokens, the `Authorization` header uses HTTP Basic Authentication. The value is `Basic ` followed by the Base64 encoding of the string `Your_Client_ID:Your_Client_Secret`.

**Q: Error: `invalid_grant` when refreshing token.**
A: This usually means:
    *   The refresh token has expired (not used within 100 days).
    *   The refresh token has been revoked.
    *   The refresh token was already used, and you didn't save the *new* refresh token returned previously (due to rotation).
    *   You are using the wrong token (e.g., an access token instead of a refresh token).
    *   You are using sandbox tokens with production endpoints or vice-versa.
    *   The grant type specified in the request body is incorrect.
    The only resolution is for the user to re-authorize your app.

**Q: Error: `invalid_client`**
A: This means the `client_id` or `client_secret` used (typically in the `Authorization: Basic ...` header) is incorrect or does not match the environment (Sandbox/Production) you are targeting. Check your keys in the Intuit Developer Portal.

**Q: Error: `redirect_uri_mismatch`**
A: The `redirect_uri` provided in the token exchange request does not exactly match the `redirect_uri` used in the initial authorization request, *or* it doesn't exactly match one of the URIs registered in the Intuit Developer Portal for your app. Ensure exact match and proper URL encoding.

**OpenID Connect**

**Q: What is OpenID Connect used for?**
A: OpenID Connect builds on OAuth 2.0 to add user authentication and identity information. Use it if you need to verify the user's identity and/or retrieve profile information (name, email, etc.).

**Q: How do I enable OpenID Connect?**
A: Include the `openid` scope in your authorization request, along with any other profile scopes (`profile`, `email`, `phone`, `address`).

**Q: What is an `id_token`?**
A: An `id_token` is a JSON Web Token (JWT) returned in the token response when you include the `openid` scope. It contains claims (information) about the authenticated user and the authentication event.

**Q: How do I validate the `id_token`?**
A: You *must* validate the `id_token` before trusting its contents:
    1.  **Decode:** Decode the JWT (header, payload, signature parts).
    2.  **Get Keys:** Fetch Intuit's public keys from the JWKS URI endpoint.
    3.  **Verify Signature:** Use the correct public key (identified by `kid` in the JWT header) to verify the token's signature.
    4.  **Verify Claims:**
        *   Check `iss` (issuer) matches the Intuit issuer URL.
        *   Check `aud` (audience) contains your app's `client_id`.
        *   Check `exp` (expiration time) is in the future.
        *   Check `iat` (issued at time) is in the past.
        *   If you sent a `nonce` in the authorization request, verify the `nonce` claim in the `id_token` matches.
    Refer to OpenID Connect specifications and JWT libraries for details.

**Q: How do I get user profile information?**
A: Two ways:
    1.  **ID Token Claims:** Include scopes like `profile`, `email`, `phone`, `address`. After validating the `id_token`, extract the corresponding claims from its payload.
    2.  **UserInfo Endpoint:** Make a GET request to the UserInfo endpoint using the `access_token` in the `Authorization: Bearer` header. The response will contain user information based on the granted scopes.

**Q: Do I need OpenID Connect just to call QuickBooks APIs?**
A: No. If you only need to access QuickBooks data (Accounting, Payments), you only need the `com.intuit.quickbooks.accounting` or `com.intuit.quickbooks.payment` scopes and standard OAuth 2.0. You only need OpenID Connect scopes (`openid`, etc.) if you specifically require user authentication or identity information.

*(End of Authentication and Authorization FAQ Section)*

---

## 3. Set Redirect URI (Full Extraction)

**(from `https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/set-redirect-uri`)**

# Set redirect URIs

*   **`QuickBooks Online API Reference Guide > Develop > Authentication and authorization > Set redirect URIs`**

**Overview**

Redirect URIs (also known as callback URLs) are a critical part of the OAuth 2.0 flow. They are the endpoints in your application where users are sent after they authorize (or deny) the connection request on the Intuit authorization server. For security reasons, you must register all your redirect URIs in the Intuit Developer Portal before they can be used in the OAuth 2.0 flow.

**Why are Redirect URIs Important?**

*   **Security:** They prevent authorization codes and tokens from being sent to malicious endpoints. Intuit's authorization server will only redirect users to pre-registered URIs.
*   **OAuth Flow:** They are the destination where your application receives the authorization `code` and `state` after successful user consent, allowing you to proceed with exchanging the code for tokens.

**Requirements for Redirect URIs**

*   **HTTPS:** All redirect URIs must use the `https` scheme. Plain `http` is not allowed for production apps. `http://localhost` is permitted for development purposes only.
*   **Exact Match:** The `redirect_uri` parameter sent in the OAuth 2.0 authorization request must be URL-encoded and must *exactly* match one of the URIs registered in the Developer Portal character for character (case-sensitive).
*   **No Wildcards:** Wildcards (`*`) are not permitted in the hostname or path.
*   **No IP Addresses:** Public IP addresses are generally not allowed (use domain names). `localhost` is the exception for development.
*   **No URL Fragments:** Fragments (`#`) are not allowed.
*   **Must be Registered:** The URI must be added to your app's settings on the Intuit Developer Portal *before* being used.

**How to Set Redirect URIs**

1.  **Log in to the Intuit Developer Portal:** Go to [developer.intuit.com](https://developer.intuit.com/) and sign in.
2.  **Navigate to Your Apps:** Go to the "Dashboard" or "My Apps" section.
3.  **Select Your Application:** Click on the name of the application you want to configure.
4.  **Go to Keys & OAuth:** In the application's settings menu (usually on the left), find and click on the "Keys & OAuth" section.
5.  **Locate Redirect URIs Section:** Scroll down to find the "Redirect URIs" section. You will typically see separate sections for Development (Sandbox) and Production keys/settings. Make sure you are editing the correct environment.
6.  **Add URI:** Click the "Add URI" or similar button.
7.  **Enter Your URI:** In the input field that appears, carefully type or paste your complete redirect URI (e.g., `https://myapp.com/oauth2/callback`). Remember it must use HTTPS.
8.  **Add Multiple URIs (Optional):** You can register multiple redirect URIs if your application needs different callback points (e.g., for different environments or flows). Click "Add URI" again for each additional one. You can register up to 25 redirect URIs per set of keys (Development/Production).
9.  **Save Changes:** Click the "Save" button at the bottom of the page or section to store your changes.

**Development vs. Production Redirect URIs**

*   **Development (Sandbox):** URIs registered under the "Development Keys" section are used when your app connects to the Sandbox environment. You can use `http://localhost` (with a specific port, e.g., `http://localhost:8080/callback`) during local development.
*   **Production:** URIs registered under the "Production Keys" section are used when your app connects to the live Production environment with real user data. These *must* use HTTPS.

**Best Practices**

*   **Be Specific:** Use the most specific path possible for your redirect URI (e.g., `https://myapp.com/integrations/quickbooks/callback` instead of just `https://myapp.com/`).
*   **Use Unique Paths:** Avoid using generic paths like `/callback` if possible, especially if your domain hosts other services.
*   **Limit the Number:** Only register URIs that are actually used by your application. Regularly review and remove unused URIs.
*   **Consistency:** Ensure the `redirect_uri` parameter value passed in the OAuth 2.0 authorization request and the token exchange request *exactly* matches the registered URI, including trailing slashes if applicable.
*   **URL Encoding:** Remember to URL-encode the `redirect_uri` when including it as a query parameter in the authorization URL.

**Example**

If you register `https://www.example.com/oauth/quickbooks` in the Developer Portal:

*   **Valid Authorization Request Parameter:** `redirect_uri=https%3A%2F%2Fwww.example.com%2Foauth%2Fquickbooks`
*   **Invalid Parameter (Mismatch):** `redirect_uri=https%3A%2F%2Fwww.example.com%2Foauth%2Fquickbooks%2F` (extra slash)
*   **Invalid Parameter (Mismatch):** `redirect_uri=http%3A%2F%2Fwww.example.com%2Foauth%2Fquickbooks` (uses http)
*   **Invalid Parameter (Not Registered):** `redirect_uri=https%3A%2F%2Fwww.example.com%2Fcallback`

**Troubleshooting `redirect_uri_mismatch` Error**

This common OAuth error occurs if the `redirect_uri` provided in your request doesn't match a registered URI. Check for:
*   Typos or case differences.
*   HTTP vs. HTTPS discrepancies.
*   Missing or extra trailing slashes.
*   Differences in ports (e.g., `:8080` vs. no port).
*   Using a URI that hasn't been added and saved in the Developer Portal settings for the correct environment (Development/Production).
*   Incorrect URL encoding.
*   Providing a different `redirect_uri` in the token exchange request than the one used in the initial authorization request.

*(End of Set Redirect URI Section)*

---

## 4. Webhooks (Full Extraction)

**(from `https://developer.intuit.com/app/developer/qbo/docs/develop/webhooks`)**

# Webhooks

*   **`QuickBooks Online API Reference Guide > Develop > Webhooks`**

**Overview**

Webhooks provide a mechanism for your application to receive real-time notifications about data changes within a user's QuickBooks Online company file, eliminating the need for constant polling. When a subscribed event occurs (e.g., an invoice is created or a customer is updated), QuickBooks Online sends an HTTP POST request containing event details to a notification endpoint URL that you configure.

**Use Cases**

*   Keeping your application's data synchronized with QuickBooks Online in near real-time.
*   Triggering workflows in your application based on QuickBooks events (e.g., sending a thank you email when an invoice is paid).
*   Monitoring specific data changes without resorting to inefficient polling.

**Key Concepts**

*   **Event:** A specific action or data change in QuickBooks Online that can trigger a notification (e.g., `Customer Create`, `Invoice Update`, `Payment Delete`).
*   **Webhook Endpoint:** A publicly accessible HTTPS URL in your application designed to receive webhook notifications from Intuit.
*   **Subscription:** Registering your webhook endpoint and selecting the specific event types you want to be notified about via the Intuit Developer Portal.
*   **Notification Payload:** The JSON data sent via HTTP POST to your endpoint when a subscribed event occurs. It includes information about the event, the company involved, and the affected entity/entities.
*   **Signature Verification:** A security mechanism to verify that incoming webhook notifications genuinely originate from Intuit. Each notification includes a signature in the `intuit-signature` HTTP header, which you must validate using your app's webhook verifier token.

**Setting up Webhooks**

1.  **Create a Webhook Endpoint:**
    *   Develop an HTTPS endpoint (URL) in your application capable of receiving HTTP POST requests.
    *   This endpoint must be publicly accessible over the internet.
    *   It should be prepared to handle JSON payloads.
    *   It *must* respond quickly (within 3 seconds) with an HTTP `200 OK` status code to acknowledge receipt of the notification. Processing should happen asynchronously.

2.  **Configure Webhooks in Intuit Developer Portal:**
    *   Log in to the [Intuit Developer Portal](https://developer.intuit.com/).
    *   Navigate to your app's dashboard.
    *   Go to the "Webhooks" section (usually under the specific app).
    *   **Enter Endpoint URL:** Provide the HTTPS URL of the endpoint you created in Step 1.
    *   **Select Events:** Choose the specific QuickBooks entities (e.g., Customer, Invoice, Payment) and the operations (Create, Update, Delete, Merge - where applicable) you want to subscribe to. Be selective to avoid unnecessary traffic.
    *   **Get Verifier Token:** A unique "Webhook Verifier" token will be displayed. Copy and securely store this token – you'll need it for signature verification.
    *   **Save:** Save your webhook configuration.

3.  **Implement Signature Verification:**
    *   In your webhook endpoint code, retrieve the `intuit-signature` header value from the incoming POST request.
    *   Retrieve the raw request body (as bytes or a string, *before* parsing it as JSON).
    *   Use HMAC-SHA256 to compute a hash of the raw request body using your stored Webhook Verifier token as the key.
    *   Encode the computed hash using Base64.
    *   Compare the Base64-encoded computed hash with the value from the `intuit-signature` header.
    *   If they match, the notification is authentic. Proceed with processing.
    *   If they *do not* match, discard the notification (it might be forged) and log the incident. Do *not* process it. Respond with `200 OK` even if verification fails to prevent Intuit from resending potentially malicious requests, but do not act on the data.

4.  **Process Notifications Asynchronously:**
    *   Upon receiving a valid notification, immediately return an HTTP `200 OK` response to Intuit (within 3 seconds).
    *   Queue the notification payload for asynchronous processing (e.g., using a background job queue). This prevents timeouts and ensures your endpoint remains responsive.
    *   The processing logic should parse the JSON payload, extract relevant information (`realmId`, entity `id`, event type), and take appropriate action (e.g., query the QBO API for the latest entity details using the provided `id`).

**Notification Payload Structure**

The POST request body contains a JSON object like this:

```json
{
  "eventNotifications": [
    {
      "realmId": "123145716876310", // The company the event occurred in
      "dataChangeEvent": {
        "entities": [
          {
            "name": "Invoice",       // Entity type
            "id": "130",             // ID of the affected entity
            "operation": "Update",   // Operation type (Create, Update, Delete, Merge)
            "lastUpdated": "2015-10-05T16:41:06-0700" // Timestamp of the event
          },
          // ... potentially more entities in the same notification batch
        ]
      }
    }
    // ... potentially more notifications if batching occurs
  ]
}
```

*   `eventNotifications`: An array of notification objects. Usually contains one, but batching is possible.
*   `realmId`: The ID of the QuickBooks company where the event happened. Use this to identify the user/connection in your system.
*   `dataChangeEvent.entities`: An array of entities affected by the event(s) in this notification.
*   `name`: The type of entity (e.g., `Customer`, `Invoice`, `Item`).
*   `id`: The unique ID of the specific entity that was changed.
*   `operation`: The action performed (`Create`, `Update`, `Delete`, `Merge`, `Void`).
*   `lastUpdated`: Timestamp of the event in QuickBooks.

**Handling Notifications**

1.  **Verify Signature:** Always the first step.
2.  **Acknowledge Receipt:** Return `200 OK` immediately.
3.  **Parse Payload:** Extract `realmId`, `name`, `id`, `operation`.
4.  **Asynchronous Processing:**
    *   Use the `realmId` to look up the corresponding user/connection and their stored OAuth 2.0 tokens in your system.
    *   Based on the `name`, `id`, and `operation`, decide on the appropriate action.
    *   **Recommended:** Often, the best practice is to use the `id` to make a Read API call to QuickBooks (using the stored tokens) to get the *current* state of the entity (`/v3/company/<realmId>/<entityNameLowerCase>/<id>`). This avoids race conditions and ensures you have the latest data, as the webhook payload itself only contains minimal information.
    *   Update your application's data based on the information retrieved from the API call or the webhook payload.
    *   Handle potential errors gracefully (e.g., API call failures, token refresh needed).

**Signature Verification Example (Conceptual Python)**

```python
import hmac
import hashlib
import base64

# --- Inside your webhook request handler ---

# Assuming 'request' is your web framework's request object
received_signature = request.headers.get('intuit-signature')
raw_body = request.get_data() # Get raw body BEFORE JSON parsing
webhook_verifier = 'YOUR_SECURELY_STORED_WEBHOOK_VERIFIER_TOKEN'

if received_signature and raw_body and webhook_verifier:
    computed_hash = hmac.new(
        webhook_verifier.encode('utf-8'),
        raw_body,
        hashlib.sha256
    ).digest()

    computed_signature = base64.b64encode(computed_hash).decode('utf-8')

    if hmac.compare_digest(computed_signature, received_signature):
        # Signatures match - Proceed with async processing
        print("Webhook signature verified.")
        # Respond 200 OK quickly
        # Queue raw_body or parsed data for background processing
        pass
    else:
        # Signatures DO NOT match - Potential tampering
        print("Webhook signature verification failed!")
        # Respond 200 OK, but DO NOT process the data and log the error
        pass
else:
    # Missing signature, body, or verifier - Invalid request
    print("Invalid webhook request received (missing header/body/verifier).")
    # Respond with an error (e.g., 400 Bad Request) or handle as appropriate
    pass

# --- End of handler ---
```

**Best Practices & Considerations**

*   **Idempotency:** Design your webhook processing logic to be idempotent. If the same notification is received multiple times (e.g., due to network issues and retries from Intuit), it should not cause duplicate actions or data corruption. Using the QBO API to fetch the latest state helps with this.
*   **Error Handling:** Implement robust error handling and logging for signature verification failures, API call errors during processing, token refresh issues, etc.
*   **Endpoint Security:** Protect your webhook endpoint URL. While signature verification confirms the sender, ensure only necessary ports are open and consider IP whitelisting if possible (though Intuit IPs may change).
*   **Retries:** Intuit will retry sending a notification if your endpoint doesn't respond with `200 OK` within 3 seconds. Retries occur with exponential backoff for up to 3 times over approximately 1 hour. If all retries fail, the notification is dropped. Consistent failures may lead to webhook deactivation.
*   **Scalability:** Ensure your endpoint and background processing infrastructure can handle the potential volume of webhook notifications, especially if you subscribe to many events or have many connected users.
*   **Monitoring:** Monitor your webhook endpoint's uptime, response times, error rates, and the health of your background processing queue.
*   **Event Selection:** Only subscribe to the events your application truly needs to minimize load on your system and Intuit's.
*   **API Calls:** Be mindful that processing a webhook often involves making subsequent API calls to QuickBooks. Ensure your application respects API rate limits.

*(End of Webhooks Section)*

---

## 5. Handling Common Errors (Full Extraction)

**(from `https://developer.intuit.com/app/developer/qbo/docs/develop/troubleshooting/handling-common-errors`)**

# Handling common errors

*   **`QuickBooks Online API Reference Guide > Develop > Troubleshooting > Handling common errors`**

**Overview**

When interacting with the QuickBooks Online API, you may encounter various errors. These can range from authentication issues and request malformations to data validation problems and service outages. Understanding common error types and how to handle them is crucial for building robust applications.

Errors are typically communicated via:

*   **HTTP Status Codes:** Standard codes indicating the general outcome of the request (e.g., `400 Bad Request`, `401 Unauthorized`, `403 Forbidden`, `404 Not Found`, `500 Internal Server Error`).
*   **Response Body:** For many `4xx` and `5xx` errors, the API response body will contain a JSON object with more specific details about the error(s).

**Common Error Response Structure**

When an API request fails with a `4xx` status code due to issues with the request data or validation, the response body often looks like this:

```json
{
  "Fault": {
    "Error": [
      {
        "Message": "Mandatory param missing", // Human-readable error message
        "Detail": "Missing required parameter CustomerRef", // More specific detail
        "code": "2010", // QuickBooks specific error code
        "element": "CustomerRef" // Field related to the error (optional)
      }
      // Potentially more Error objects if multiple issues exist
    ],
    "type": "ValidationFault" // Type of fault (e.g., ValidationFault, AuthenticationFault, SystemFault)
  },
  "time": "2015-07-24T10:49:15.491-07:00" // Timestamp of the response
}
```

*   `Fault`: The main container for error details.
*   `Error`: An array containing one or more specific error objects.
*   `Message`: General description of the error.
*   `Detail`: Specific information about the error cause.
*   `code`: A QuickBooks-specific error code string. Useful for programmatic handling and lookup.
*   `element`: (Optional) The specific field or element in your request that caused the error.
*   `type`: Categorizes the fault (e.g., `ValidationFault`, `AuthenticationFault`, `AuthorizationFault`, `SystemFault`).

**Common HTTP Status Codes and Their Meanings**

*   **`200 OK`:** Success. The request was processed successfully. The response body contains the requested resource or the result of the operation.
*   **`400 Bad Request`:** Generally indicates a problem with the client's request, such as malformed JSON, missing required fields, invalid data formats, or validation errors against business rules. The response body usually contains a `ValidationFault` with specific error codes and details.
    *   *Action:* Inspect the response body's `Fault.Error` array for details. Correct the request payload based on the error message, detail, code, and element. Check documentation for required fields and data formats.
*   **`401 Unauthorized`:** Authentication failed. This usually means the `access_token` provided in the `Authorization: Bearer` header is invalid, expired, or revoked. It can also occur if the `Authorization` header is missing or malformed, or if the `client_id`/`client_secret` used in token requests (`Authorization: Basic`) are incorrect.
    *   *Action:*
        1.  If the access token might have expired, attempt to refresh it using the stored refresh token.
        2.  If refreshing fails (e.g., `invalid_grant` error) or if you suspect the token is invalid/revoked, the user must re-authorize your application through the OAuth 2.0 flow.
        3.  Verify your `Authorization` header format is correct (`Bearer <token>` for API calls, `Basic <base64(id:secret)>` for token calls).
        4.  Ensure you are using the correct keys (Sandbox/Production) for the target environment.
*   **`403 Forbidden`:** Authentication succeeded, but the authenticated user (or your application) does not have permission to access the requested resource or perform the requested operation.
    *   *Action:*
        1.  Check the OAuth scopes granted during authorization. Does the connection have the necessary scope (e.g., `com.intuit.quickbooks.accounting`)?
        2.  Verify the user has the appropriate permissions within QuickBooks Online itself for the action they are trying to perform via the API.
        3.  Ensure your app has been approved for the necessary scopes in the production environment if applicable.
*   **`404 Not Found`:** The requested resource (e.g., a specific Invoice ID, Customer ID) does not exist for the given `realmId`, or the API endpoint path itself is incorrect.
    *   *Action:* Verify the resource ID and `realmId` are correct. Double-check the API endpoint URL path in your request. Ensure the object hasn't been deleted or merged.
*   **`405 Method Not Allowed`:** The HTTP method used (e.g., GET, POST, PUT, DELETE) is not supported for the requested endpoint.
    *   *Action:* Check the API documentation for the correct HTTP method for the desired operation on that endpoint.
*   **`413 Payload Too Large`:** The request body size exceeds the server's limit. This might happen with large batch requests or report queries with extensive data.
    *   *Action:* Reduce the size of the request payload. Process data in smaller batches. Refine report query parameters.
*   **`429 Too Many Requests`:** Your application has exceeded the API rate limits. QuickBooks Online enforces throttling limits to ensure fair usage.
    *   *Action:* Implement rate limiting and exponential backoff strategies in your application. Reduce the frequency of API calls. Optimize workflows to minimize requests. Check the specific rate limiting documentation for details on thresholds.
*   **`500 Internal Server Error`:** An unexpected error occurred on the Intuit server side. This is not typically an issue with your request itself. The response body may contain a `SystemFault`.
    *   *Action:* Retry the request after a short delay (implement exponential backoff). If the error persists, check the Intuit Developer status page or forums for known outages. Report persistent 500 errors to Intuit support if no outage is indicated. Log the error details, including the `intuit_tid` response header if available (useful for Intuit support).
*   **`502 Bad Gateway / 503 Service Unavailable / 504 Gateway Timeout`:** Indicate temporary problems with Intuit's backend services or network infrastructure.
    *   *Action:* Treat similarly to `500 Internal Server Error`. Implement retry logic with exponential backoff. Check status pages. These are typically transient issues.

**Common QuickBooks Error Codes (Examples from `Fault.Error.code`)**

*   **`2000` Series (Validation Errors):**
    *   `2010`: Mandatory parameter missing (e.g., `Missing required parameter CustomerRef`). `Detail` often specifies the missing field.
    *   `2020`: Invalid data format (e.g., `Invalid Date format`). Check expected format (e.g., `YYYY-MM-DD`).
    *   `2040`: Invalid reference ID (e.g., `Invalid ID: Reference Id not found`). The `Id` provided for a reference field (like `CustomerRef.value`) doesn't exist.
    *   `2050`: Invalid number format.
    *   `2060`: Invalid enum value (e.g., providing an incorrect `AccountType`).
    *   `2070`: Name conflict (e.g., `The name supplied already exists`). DisplayNames for Customer/Vendor/Employee/Account must be unique.
    *   `2080`: Invalid number (out of range).
    *   `2090`: String length exceeds maximum allowed. `Detail` often specifies the field and max length.
    *   `2160`: Invalid transaction type.
    *   `2500`: Transaction amount validation error (e.g., `TotalAmt does not equal sum of lines`).
*   **`5000` Series (Business Logic/Rule Violations):**
    *   `5010`: Stale object error (Optimistic Locking). The `SyncToken` provided in an update request does not match the current version on the server, meaning the object was modified since you last read it. Action: Re-read the object to get the latest `SyncToken` and data, then re-apply your changes and retry the update with the new `SyncToken`.
    *   `5070`: Cannot make an account inactive if it has a non-zero balance.
    *   `5080`: Cannot delete object. It is referenced by transactions or other list items. Action: Make the object inactive instead.
    *   `5220`: Duplicate document number error. Occurs if `Preferences.CustomTxnNumbers` is enabled and you try to create a transaction with a `DocNumber` already in use for that transaction type.
    *   `5600`: Invalid operation. Attempting an action not allowed by business rules (e.g., trying to link incompatible transaction types).
*   **`6000` Series (More Business Logic/Data Errors):**
    *   `6000`: Generic internal error processing data. Detail might provide more context. Retrying might help, but often indicates a data issue.
    *   `6140`: Transaction Splitting Error. Issue with how transaction lines are balanced or assigned accounts.
    *   `6190`: Authentication失効 (Authentication Revoked). Similar to 401, but can sometimes appear here. User needs to re-auth.
    *   `6200`: Invalid Account Type. Using an account in a context where its type is inappropriate (e.g., trying to use an Expense account as `DepositToAccountRef`).
    *   `6210`: Account Period Closed. Trying to modify transactions in a closed accounting period.
    *   `6240`: Data Validation Failed. A general data validation error not covered by more specific codes. Check `Detail`.
    *   `6280`: Email Address Validation Error. Invalid format for an email address field.
    *   `6430`: Company File Mismatch (Wrong `realmId`). Trying to operate on a company different from the one specified in the URL path's `realmId`.
*   **`10000` Series (Authorization/Authentication):**
    *   `10000`: Authentication failed (similar to 401).
    *   `10010`: Authorization failed (similar to 403).

**Handling Strategies**

1.  **Check HTTP Status Code First:** Determine the general category of the error.
2.  **Parse Response Body (for 4xx/5xx):** Extract `Fault.Error` details (`code`, `Message`, `Detail`, `element`).
3.  **Log Thoroughly:** Log the full request (URL, method, headers *excluding sensitive data like Authorization*, body), the full response (status code, headers including `intuit_tid`, body), and the timestamp. This is invaluable for debugging.
4.  **Implement Conditional Logic:**
    *   **For 401:** Trigger the token refresh mechanism. If refresh fails, prompt user re-authentication.
    *   **For 429:** Implement exponential backoff and retry.
    *   **For 5xx:** Implement exponential backoff and retry a few times. Log persistent errors.
    *   **For 400 (`ValidationFault`):**
        *   If error code is `5010` (Stale Object), implement the read-modify-retry pattern.
        *   For other validation codes, log the error, and ideally, provide user-friendly feedback based on the `Message` and `Detail` so the user can correct the input. Do not blindly retry validation errors without fixing the underlying data issue.
    *   **For 403:** Check scopes, user permissions. Inform the user if they lack permissions.
    *   **For 404:** Verify IDs. Inform the user if the resource seems missing.
5.  **User Feedback:** Translate technical error messages (`Message`, `Detail`) into clear, actionable feedback for the end-user whenever possible, especially for validation errors.
6.  **SDK Error Handling:** If using an Intuit SDK, familiarize yourself with its specific exception types and how they map to API errors. SDKs often wrap API errors in custom exception classes.

**`intuit_tid` Header**

The API response may include an `intuit_tid` header (e.g., `intuit_tid: 1-5f8f8f8f-1234567890abcdef12345678`). This is a unique transaction ID generated by Intuit's systems. Include this ID when reporting persistent issues (especially 5xx errors) to Intuit support, as it helps them trace the specific request on their end.

*(End of Handling Common Errors Section)*

---